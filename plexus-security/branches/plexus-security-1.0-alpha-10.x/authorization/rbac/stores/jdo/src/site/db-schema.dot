// Graph of desired database structure.
//   Use GraphViz (available from www.graphviz.org) to generate the image.
// 
// Command line: dot -Tpng db-schema.dot -o db-schema.png

digraph structs {
  // Graph Defaults
  graph [
    rankdir="RL"
    bgcolor="#f7f7f7"
    label="\nGenerated by GraphViz"
    labeljust="l"
  ];

  // Node Defaults.
  node [
    fontname="Helvetica"
    fontsize="11"
    shape="plaintext"
  ];

  // Edge Defaults.  
  edge [
    arrowsize="0.8"
  ];

  // The Nodes
  "KEY" [
    label=<
    <TABLE BORDER="1" CELLBORDER="0" CELLSPACING="0" CELLPADDING="5" BGCOLOR="#EEEEEE">
    <TR><TD>KEY</TD></TR>
    <TR><TD>
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD BGCOLOR="#9bab96" ALIGN="CENTER">
        [TABLE NAME]
      </TD></TR>
      <TR><TD ALIGN="LEFT" BGCOLOR="#def1b8">
        [COLUMN / PRIMARY KEY]
      </TD></TR>
      <TR><TD ALIGN="LEFT" BGCOLOR="#fffacd">
        [COLUMN / INDEXED]
      </TD></TR>
      <TR><TD ALIGN="LEFT">
        [COLUMN]
      </TD></TR>
    </TABLE>
    </TD></TR>
    </TABLE>>
  ];

  "ROLES" [
    label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD PORT="ROLES.heading" BGCOLOR="#9bab96" ALIGN="CENTER">
        ROLES
      </TD></TR>
      <TR><TD PORT="NAME" ALIGN="LEFT" BGCOLOR="#def1b8">
        NAME
      </TD></TR>
      <TR><TD PORT="DESCRIPTION" ALIGN="LEFT">
        DESCRIPTION
      </TD></TR>
      <TR><TD PORT="ASSIGNABLE" ALIGN="LEFT">
        ASSIGNABLE
      </TD></TR>
    </TABLE>>
  ];

  "ROLE_PERMISSION_MAP" [
    label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD PORT="ROLE_PERMISSION_MAP.heading" BGCOLOR="#9bab96" ALIGN="CENTER">
        ROLE_PERMISSION_MAP
      </TD></TR>
      <TR><TD PORT="ROLE_NAME" ALIGN="LEFT" BGCOLOR="#fffacd">
        ROLE_NAME
      </TD></TR>
      <TR><TD PORT="PERMISSION_NAME" ALIGN="LEFT" BGCOLOR="#fffacd">
        PERMISSION_NAME
      </TD></TR>
    </TABLE>>
  ];

  "ROLE_ROLE_MAP" [
    label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD PORT="ROLE_ROLE_MAP.heading" BGCOLOR="#9bab96" ALIGN="CENTER">
        ROLE_ROLE_MAP
      </TD></TR>
      <TR><TD PORT="PARENT_ROLE_NAME" ALIGN="LEFT" BGCOLOR="#fffacd">
        PARENT_ROLE_NAME
      </TD></TR>
      <TR><TD PORT="CHILD_ROLE_NAME" ALIGN="LEFT" BGCOLOR="#fffacd">
        CHILD_ROLE_NAME
      </TD></TR>
    </TABLE>>
  ];

  "PERMISSIONS" [
    label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD PORT="PERMISSIONS.heading" BGCOLOR="#9bab96" ALIGN="CENTER">
        PERMISSIONS
      </TD></TR>
      <TR><TD PORT="NAME" ALIGN="LEFT" BGCOLOR="#def1b8">
        NAME
      </TD></TR>
      <TR><TD PORT="DESCRIPTION" ALIGN="LEFT">
        DESCRIPTION
      </TD></TR>
      <TR><TD PORT="OPERATION_NAME" ALIGN="LEFT" BGCOLOR="#fffacd">
        OPERATION_NAME
      </TD></TR>
      <TR><TD PORT="RESOURCE_IDENTIFIER" ALIGN="LEFT" BGCOLOR="#fffacd">
        RESOURCE_IDENTIFIER
      </TD></TR>
    </TABLE>>
  ];

  "OPERATIONS" [
    label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD PORT="OPERATIONS.heading" BGCOLOR="#9bab96" ALIGN="CENTER">
        OPERATIONS
      </TD></TR>
      <TR><TD PORT="NAME" ALIGN="LEFT" BGCOLOR="#def1b8">
        NAME
      </TD></TR>
      <TR><TD PORT="DESCRIPTION" ALIGN="LEFT">
        DESCRIPTION
      </TD></TR>
      <TR><TD PORT="RESOURCE_REQUIRED" ALIGN="LEFT">
        RESOURCE_REQUIRED
      </TD></TR>
    </TABLE>>
  ];

  "RESOURCES" [
    label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD PORT="RESOURCES.heading" BGCOLOR="#9bab96" ALIGN="CENTER">
        RESOURCES
      </TD></TR>
      <TR><TD PORT="IDENTIFIER" ALIGN="LEFT" BGCOLOR="#def1b8">
        IDENTIFIER
      </TD></TR>
      <TR><TD PORT="PATTERN" ALIGN="LEFT">
        PATTERN
      </TD></TR>
    </TABLE>>
  ];

  "USER_ASSIGNMENTS" [
    label=<
    <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#ffffff">
      <TR><TD PORT="USER_ASSIGNMENTS.heading" BGCOLOR="#9bab96" ALIGN="CENTER">
        USER_ASSIGNMENTS
      </TD></TR>
      <TR><TD PORT="PRINCIPAL" ALIGN="LEFT" BGCOLOR="#fffacd">
        PRINCIPAL
      </TD></TR>
      <TR><TD PORT="ROLE_NAME" ALIGN="LEFT" BGCOLOR="#fffacd">
        ROLE_NAME
      </TD></TR>
    </TABLE>>
  ];

  // The Connections
  "PERMISSIONS":"NAME" ->
    "ROLE_PERMISSION_MAP":"PERMISSION_NAME"
    [arrowtail=none arrowhead=dot];

  "PERMISSIONS":"OPERATION_NAME":w ->
    "OPERATIONS":"NAME":e
    [arrowtail=none arrowhead=normal];

  "PERMISSIONS":"RESOURCE_IDENTIFIER" ->
    "RESOURCES":"IDENTIFIER"
    [arrowtail=none arrowhead=normal];

  "USER_ASSIGNMENTS":"ROLE_NAME" ->
    "ROLES":"NAME"
    [arrowtail=none arrowhead=normal];

  "ROLES":"NAME":w ->
    "ROLE_PERMISSION_MAP":"ROLE_NAME":e
    [arrowtail=none arrowhead=dot];

  "ROLES":"NAME" ->
    "ROLE_ROLE_MAP":"PARENT_ROLE_NAME"
    [arrowtail=none arrowhead=dot];

  "ROLE_ROLE_MAP":"CHILD_ROLE_NAME" ->
    "ROLES":"NAME"
    [arrowtail=none arrowhead=dot];
}
