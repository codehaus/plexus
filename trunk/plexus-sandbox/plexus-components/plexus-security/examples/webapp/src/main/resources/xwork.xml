<?xml version="1.0" ?>
<!DOCTYPE xwork PUBLIC "-//OpenSymphony Group//XWork 1.1.1//EN" "http://www.opensymphony.com/xwork/xwork-1.1.1.dtd">

<xwork>
  <include file="webwork-default.xml"/>

  <package name="default" extends="webwork-default" namespace="/">

    <default-interceptor-ref name="defaultStack"/>

    <action name="plexusSecuritySystem" class="plexusSecuritySystem">
      <result name="success">/plexusSecuritySystem.jsp</result>
    </action>

    <action name="login" class="session" method="login">
      <result name="input">/login.jsp</result>
      <result name="error">/login.jsp</result>
      <result name="success" type="chain">status</result>
    </action>

    <action name="newuser" class="session" method="newuser">
      <result name="success">/login.jsp</result>
      <result name="error">/newuser.jsp</result>
    </action>

    <action name="logout" class="session" method="logout">
      <result name="error">/status.jsp</result>
      <result name="success" type="chain">status</result>
    </action>

    <action name="status" class="status" method="status">
      <result name="error">/status.jsp</result>
      <result name="success">/status.jsp</result>
    </action>


    <!-- rbac actions -->
    <action name="permissions" class="plexusSecuritySummary" method="permissionSummary">
      <result name="success">/permissions.jsp</result>
    </action>

    <action name="permission" class="plexusSecurityPermission">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success">/permission.jsp</result>
    </action>

    <action name="savePermission" class="plexusSecurityPermission" method="save">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success" type="redirect-action">permissions</result>
    </action>

    <action name="removePermission" class="plexusSecurityPermission" method="remove">
      <result name="success" type="redirect-action">permissions</result>
    </action>

    <action name="operations" class="plexusSecuritySummary" method="operationSummary">
      <result name="success">/operations.jsp</result>
    </action>

    <action name="operation" class="plexusSecurityOperation">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success">/operation.jsp</result>
    </action>

    <action name="saveOperation" class="plexusSecurityOperation" method="save">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success" type="redirect-action">operations</result>
    </action>

    <action name="removeOperation" class="plexusSecurityOperation" method="remove">
      <result name="success" type="redirect-action">operations</result>
    </action>

    <action name="resources" class="plexusSecuritySummary" method="resourceSummary">
      <result name="success">/resources.jsp</result>
    </action>

    <action name="resource" class="plexusSecurityResource">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success">/resource.jsp</result>
    </action>

    <action name="saveResource" class="plexusSecurityResource" method="save">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success" type="redirect-action">resources</result>
    </action>

    <action name="removeResource" class="plexusSecurityResource" method="remove">
      <result name="success">/resources.jsp</result>
    </action>

    <action name="roles" class="plexusSecuritySummary" method="roleSummary">
      <result name="success">/roles.jsp</result>
    </action>

    <action name="role" class="plexusSecurityRole">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success">/role.jsp</result>
    </action>

    <action name="saveRole" class="plexusSecurityRole" method="save">
      <interceptor-ref name="paramsPrepareParamsStack"/>
      <result name="success" type="redirect-action">roles</result>
    </action>

    <action name="removeRole" class="plexusSecurityRole" method="remove">
      <result name="success" type="redirect-action">roles</result>
    </action>

    <action name="removeAssignedRole" class="plexusSecurityRole" method="removeAssignedRole">
      <result name="success" type="chain">role</result>
    </action>

    <action name="removeAssignedPermission" class="plexusSecurityRole" method="removeAssignedPermission">
      <result name="success" type="chain">role</result>
    </action>

  </package>
</xwork>
